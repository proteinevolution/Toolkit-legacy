<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc on Sat Mar 09 17:00:21 CST 2002 -->
<TITLE>
FORESTER 1.92 API specification: Class  OE
</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">
</HEAD>
<BODY BGCOLOR="white">

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_top"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
FORESTER 1.92</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../forester/tools/NameAndValues.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../forester/tools/RIO.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="OE.html" TARGET="_top"><B>NO FRAMES</B></A></FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY: &nbsp;INNER&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL: &nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
forester.tools</FONT>
<BR>
Class  OE</H2>
<PRE>
java.lang.Object
  |
  +--<A HREF="../../forester/tools/SDI.html">forester.tools.SDI</A>
        |
        +--<B>forester.tools.OE</B>
</PRE>
<HR>
<DL>
<DT>public class <B>OE</B><DT>extends <A HREF="../../forester/tools/SDI.html">SDI</A></DL>

<P>
Implements Oliver Eulenstein's algorithm for speciation - duplication inference.

<p>
References:
</p>
<ul>
<li>
Oliver Eulenstein (1998) "Vorhersage von Genduplikationen und 
deren Entwicklung in der Evolution" GMD Research Series, No 20/1998, 
GMD - Forschungszentrum Informationstechnik GmbH. - Sankt Augustin. 
http://www.gmd.de/publications/research/1998/020/
<li>
Oliver Eulenstein (1996) "A linear time algorithm for tree mapping" 
Arbeitspapiere der GMD No. 1046, St Augustine, Germany.
</ul>

<p>
The initialization is accomplished by:
</p>
<ul>
<li>
"stripTree(Tree,Tree)" of class SDI: stripping of the species tree
<li>
"preorderReID(int)" of class Tree: numbering of nodes of species and gene tree in preorder
<li>
"hashIDs()" of class Tree: Enables nodes to be retrieved in constant time, given their ID number
<li>
"setIndicatorsToZero()" of class Tree: Initializing indicators
<li>
"linkExtNodesOfS()" of this class: Setting the links for the external nodes of the species tree
</ul>

<p>
The recursion part is accomplished by method "DFS(Node)" of this class

<p>
Duplication and speciations are determined by "determine(Node)" of this class.

<p>
Requires JDK 1.2 or greater.
<P>
<DL>
<DT><B>Version: </B><DD>1.012 -- last modified: 10/02/01</DD>
<DT><B>Author: </B><DD>Christian M. Zmasek</DD>
<DT><B>See Also: </B><DD><A HREF="../../forester/tools/SDI.html#stripTree(forester.tree.Tree, forester.tree.Tree)"><CODE>SDI.stripTree(Tree,Tree)</CODE></A>, 
<A HREF="../../forester/tree/Tree.html#preorderReID(int)"><CODE>Tree.preorderReID(int)</CODE></A>, 
<A HREF="../../forester/tree/Tree.html#hashIDs()"><CODE>Tree.hashIDs()</CODE></A>, 
<A HREF="../../forester/tree/Tree.html#setIndicatorsToZero()"><CODE>Tree.setIndicatorsToZero()</CODE></A>, 
<A HREF="../../forester/tools/OE.html#linkExtNodesOfS()"><CODE>linkExtNodesOfS()</CODE></A>, 
<A HREF="../../forester/tools/OE.html#DFS(forester.tree.Node)"><CODE>DFS(Node)</CODE></A>, 
<A HREF="../../forester/tools/OE.html#determine(forester.tree.Node)"><CODE>determine(Node)</CODE></A></DL>
<HR>

<P>
<!-- ======== INNER CLASS SUMMARY ======== -->


<!-- =========== FIELD SUMMARY =========== -->


<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../forester/tools/OE.html#OE(forester.tree.Tree, forester.tree.Tree)">OE</A></B>(<A HREF="../../forester/tree/Tree.html">Tree</A>&nbsp;gene_tree,
   <A HREF="../../forester/tree/Tree.html">Tree</A>&nbsp;species_tree)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor which sets the gene tree and the species tree to be
compared.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Method Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../forester/tools/OE.html#computeMappingCost()">computeMappingCost</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computes the cost of mapping the gene tree gene_tree onto the
species tree species_tree.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../forester/tools/OE.html#determine(forester.tree.Node)">determine</A></B>(<A HREF="../../forester/tree/Node.html">Node</A>&nbsp;g)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Determines which nodes of the subtree of gene tree node g represent
duplications and which ones speciations.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../forester/tools/OE.html#DFS(forester.tree.Node)">DFS</A></B>(<A HREF="../../forester/tree/Node.html">Node</A>&nbsp;s)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Traverses the species tree in postorder.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../forester/tools/OE.html#infer(boolean)">infer</A></B>(boolean&nbsp;strip_species_tree)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Infers for each Node of gene_tree (set in constructor) whether it
represents a speciation or duplication event by calculating 
and interpreting the mapping function M.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../forester/tools/OE.html#linkExtNodesOfS()">linkExtNodesOfS</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Links each external Node of the species tree to the all external
nodes of the gene tree which have the same species name.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_forester.tools.SDI"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from class forester.tools.<A HREF="../../forester/tools/SDI.html">SDI</A></B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../forester/tools/SDI.html#decreaseDuplications()">decreaseDuplications</A>, <A HREF="../../forester/tools/SDI.html#getDuplications()">getDuplications</A>, <A HREF="../../forester/tools/SDI.html#getGeneTree()">getGeneTree</A>, <A HREF="../../forester/tools/SDI.html#getMappingCost()">getMappingCost</A>, <A HREF="../../forester/tools/SDI.html#getSpeciesTree()">getSpeciesTree</A>, <A HREF="../../forester/tools/SDI.html#increaseDuplications()">increaseDuplications</A>, <A HREF="../../forester/tools/SDI.html#linkExtNodesOfG()">linkExtNodesOfG</A>, <A HREF="../../forester/tools/SDI.html#main(java.lang.String[])">main</A>, <A HREF="../../forester/tools/SDI.html#setDuplicationsToZero()">setDuplicationsToZero</A>, <A HREF="../../forester/tools/SDI.html#stripTree(forester.tree.Tree, forester.tree.Tree)">stripTree</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from class java.lang.Object</B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><clinit>, clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->


<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="OE(forester.tree.Tree, forester.tree.Tree)"><!-- --></A><H3>
OE</H3>
<PRE>
public <B>OE</B>(<A HREF="../../forester/tree/Tree.html">Tree</A>&nbsp;gene_tree,
          <A HREF="../../forester/tree/Tree.html">Tree</A>&nbsp;species_tree)
   throws java.lang.Exception</PRE>
<DL>
<DD>Constructor which sets the gene tree and the species tree to be
compared. species_tree is the species tree to which the gene
tree gene_tree will be compared to - with method "infer(boolean)".
Both Trees must be completely binary and rooted.
The actual inference is accomplished with method "infer(boolean)".
The mapping cost L can then be calculated with method "computeMappingCost()".
<br>
(Last modified: 01/11/01)
<br><DD><DL>
<DT><B>Parameters:</B><DD><CODE>gene_tree</CODE> - reference to a rooted binary gene Tree to which assign
duplication vs speciation, must have species names in 
the species name fields for all external nodes<DD><CODE>species_tree</CODE> - reference to a rooted binary species Tree which might
get stripped in the process, must have species names in 
the species name fields for all external nodes<DT><B>See Also: </B><DD><A HREF="../../forester/tools/OE.html#infer(boolean)"><CODE>infer(boolean)</CODE></A>, 
<A HREF="../../forester/tools/OE.html#computeMappingCost()"><CODE>computeMappingCost()</CODE></A></DL>
</DD>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Method Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="infer(boolean)"><!-- --></A><H3>
infer</H3>
<PRE>
public int <B>infer</B>(boolean&nbsp;strip_species_tree)
          throws java.lang.Exception</PRE>
<DL>
<DD>Infers for each Node of gene_tree (set in constructor) whether it
represents a speciation or duplication event by calculating 
and interpreting the mapping function M. The most parsimonious
sequence of speciation and duplication events is assumed.
<p>
The species tree MUST NOT contain species not found in the gene tree.
If it does, set strip_species_tree to true.
<p>
(Last modified: 01/11/01)
<br><DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../forester/tools/SDI.html#infer(boolean)">infer</A></CODE> in class <CODE><A HREF="../../forester/tools/SDI.html">SDI</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>strip_species_tree</CODE> - set to true if species are present in the
species tree which are not in the gene tree
(not optional!)<DT><B>Returns:</B><DD>number of duplications which have been assigned in gene_tree</DL>
</DD>
</DL>
<HR>

<A NAME="computeMappingCost()"><!-- --></A><H3>
computeMappingCost</H3>
<PRE>
public int <B>computeMappingCost</B>()
                       throws java.lang.Exception</PRE>
<DL>
<DD>Computes the cost of mapping the gene tree gene_tree onto the
species tree species_tree. Before this method can be called,
the mapping has to be calculated with method "infer(boolean)".
<p>
Overrides the method of the base class, since additionaly the
links for the gene tree have to be calculated first.
<p>
Reference. Zhang, L. (1997) On a Mirkin-Muchnik-Smith Conjecture
for Comparing Molecular Phylogenies. Journal of Computational
Biology 4 177-187.
<p>
(Last modified: 11/07/00)
<br><DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../forester/tools/SDI.html#computeMappingCost()">computeMappingCost</A></CODE> in class <CODE><A HREF="../../forester/tools/SDI.html">SDI</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Returns:</B><DD>the mapping cost "L"</DL>
</DD>
</DL>
<HR>

<A NAME="DFS(forester.tree.Node)"><!-- --></A><H3>
DFS</H3>
<PRE>
void <B>DFS</B>(<A HREF="../../forester/tree/Node.html">Node</A>&nbsp;s)</PRE>
<DL>
<DD>Traverses the species tree in postorder. Creates Baskets for
each external node.
<p>
(Last modified: 01/11/01)
<br></DL>
<HR>

<A NAME="linkExtNodesOfS()"><!-- --></A><H3>
linkExtNodesOfS</H3>
<PRE>
void <B>linkExtNodesOfS</B>()
               throws java.lang.Exception</PRE>
<DL>
<DD>Links each external Node of the species tree to the all external
nodes of the gene tree which have the same species name.
<p>
The matching Nodes of the gene tree are placed in a Vector associated with
each external Nodes of the species tree. This is necessary in order to deal
with redundant species in the gene tree and is not part of the algorithm
as described in Eulenstein (1998), but it is mentioned in Eulenstein (1996). 
<p>
(Last modified: 01/11/01)
<br></DL>
<HR>

<A NAME="determine(forester.tree.Node)"><!-- --></A><H3>
determine</H3>
<PRE>
void <B>determine</B>(<A HREF="../../forester/tree/Node.html">Node</A>&nbsp;g)</PRE>
<DL>
<DD>Determines which nodes of the subtree of gene tree node g represent
duplications and which ones speciations.
<p>
Precondition: Mapping function M for all nodes of the gene tree
must have been calculated.
<p>
(Last modified: 01/11/01)
<br><DD><DL>
<DT><B>Parameters:</B><DD><CODE>g</CODE> - starting node of a gene tree - normally the root</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_bottom"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
FORESTER 1.92</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../forester/tools/NameAndValues.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../forester/tools/RIO.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="OE.html" TARGET="_top"><B>NO FRAMES</B></A></FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY: &nbsp;INNER&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL: &nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>

</BODY>
</HTML>
